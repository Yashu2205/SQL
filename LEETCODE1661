SELECT DISTINCT  A.MACHINE_ID,
AVG(B.TIMESTAMP - A.TIMESTAMP) OVER (PARTITION BY A.MACHINE_ID  ORDER BY A.MACHINE_ID) 
AS processing_time 
FROM Activity A INNER JOIN Activity B
ON A.process_id = B.process_id 
AND A.MACHINE_ID=B.MACHINE_ID AND
B.timestamp >A.TIMESTAMP
